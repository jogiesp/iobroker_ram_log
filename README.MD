# ğŸ ioBroker-Logs im RAM â€“ Das Projekt, das deine SD-Karte liebt 

Willkommen zu unserem genialen **iobroker-Log-Projekt**, das die SD-Karte deines Raspberry Pi schÃ¼tzt:

> SD-Karten sind wie kleine Hunde ğŸ¶: Man muss gut zu ihnen sein, sonst werden sie mÃ¼de und kaputt ğŸ’”.

Wir haben eine **clevere LÃ¶sung**, die dafÃ¼r sorgt, dass **alle Log-Dateien von ioBroker in den RAM geschrieben werden**, also in den blitzschnellen Arbeitsspeicher des Pi âš¡.

**Das bedeutet:**

* Deine SD-Karte wird **nicht mehr stÃ¤ndig vollgeschrieben** ğŸ›¡ï¸
* Dein Raspberry Pi bleibt **schnell, glÃ¼cklich und gesund** ğŸ˜
* Ein kleiner Helfer (Cron) sorgt dafÃ¼r, dass **alte Logs automatisch gelÃ¶scht werden** âœ¨

---

## ğŸ¯ Was dieses Projekt tut

1. Es wird ein **RAM-Verzeichnis** erstellt (`/run/iobroker-logs`), das beim Neustart leer ist ğŸ’¨.
2. Die bisherigen Log-Dateien werden dorthin verschoben, und ein **symbolischer Link** sorgt dafÃ¼r, dass ioBroker denkt, alles sei wie gewohnt (`/opt/iobroker/log`) ğŸ”—.
3. Ein **Cron-Job mit `@reboot`** erstellt das RAM-Verzeichnis und startet ioBroker beim Boot.
4. Alte Logs im RAM werden automatisch gelÃ¶scht â€“ alles lÃ¤uft **von alleine**.

---

## âš ï¸ Wichtiger Punkt: Cron beim Boot

> Dies ist **der entscheidende Punkt**, damit ioBroker nach jedem Neustart funktioniert.
> Wenn Cron nicht korrekt eingerichtet ist, startet ioBroker **nicht** und Logs existieren nicht.

---

## ğŸ§‘â€ğŸ’» Anleitung â€“ Schritt fÃ¼r Schritt

### 1ï¸âƒ£ Vorbereitendes Skript erstellen

```bash
sudo nano /usr/local/bin/iobroker-ramlog.sh
```

Inhalt:

```bash
#!/bin/bash
# RAM-Log fÃ¼r ioBroker vorbereiten

# 1. RAM-Verzeichnis anlegen
mkdir -p /run/iobroker-logs/iobroker
chown -R iobroker:iobroker /run/iobroker-logs

# 2. Symbolischen Link setzen
ln -sfn /run/iobroker-logs/iobroker /opt/iobroker/log

# 3. ioBroker starten
systemctl start iobroker.service
```

Speichern und ausfÃ¼hrbar machen:

```bash
sudo chmod +x /usr/local/bin/iobroker-ramlog.sh
```

---

### 2ï¸âƒ£ Cron-Job fÃ¼r Boot einrichten

* Cron fÃ¼r root bearbeiten:

```bash
sudo crontab -e
```

* Folgende Zeile hinzufÃ¼gen:

```cron
@reboot /usr/local/bin/iobroker-ramlog.sh
```

ğŸ’¡ **ErklÃ¤rung:**

* `@reboot` â†’ Skript wird **bei jedem Boot automatisch ausgefÃ¼hrt**
* Erst wird das RAM-Verzeichnis erstellt, dann der Link gesetzt, und iobroker gestartet

> **WICHTIG:** Ohne diesen Schritt startet ioBroker nach einem Neustart **nicht** und das RAM-Log existiert nicht. Dies ist der zentrale Punkt fÃ¼r eine funktionierende Einrichtung!

---

### 3ï¸âƒ£ Cron-Job: Alte Logs lÃ¶schen (optional)

Damit der RAM nicht voll wird, kannst du einen weiteren Cron-Job einrichten, z.â€¯B. alle 2 Tage:

```bash
sudo crontab -e
```

FÃ¼ge hinzu:

```cron
0 4 */2 * * rm -rf /run/iobroker-logs/iobroker/*
```

* `0 4 */2 * *` â†’ alle 2 Tage um 04:00 Uhr morgens
* `rm -rf /run/iobroker-logs/iobroker/*` â†’ lÃ¶scht alle Dateien im Log-Verzeichnis
* ioBroker legt beim nÃ¤chsten Log-Eintrag automatisch neue Dateien an

---

### 4ï¸âƒ£ Test

* Neustart durchfÃ¼hren:

```bash
sudo reboot
```

* PrÃ¼fen:

```bash
ls -l /run/iobroker-logs/iobroker
tail -f /opt/iobroker/log/iobroker.current.log
systemctl status iobroker.service
```

âœ… Ergebnis:

* RAM-Verzeichnis existiert sofort nach Boot
* Symbolischer Link ist korrekt
* ioBroker startet automatisch
* Alte Logs kÃ¶nnen per Cron gelÃ¶scht werden

---

## ğŸ’¡ Bonus-Tipps

* Backup-Skripte einbauen, falls bestimmte Logs doch auf SD gespeichert werden sollen ğŸ’¾
* Logs live beobachten:

```bash
tail -f /opt/iobroker/log/iobroker.current.log
```

* Die SD-Karte wird entspannt geschont ğŸ¶ğŸ›‹ï¸, wÃ¤hrend der RAM alles erledigt âš¡

---

## âœ… Vorteile

* SD-Karte wird **geschont** â€“ weniger VerschleiÃŸ
* ioBroker-Logs werden **schnell im RAM geschrieben**
* Automatisches LÃ¶schen alter Logs verhindert RAM-Stau
* Einfache Einrichtung Ã¼ber Cron, **kein komplexes Systemd-GedÃ¶ns**
* FÃ¼r AnfÃ¤nger leicht verstÃ¤ndlich

---

## âš ï¸ Nachteile / Risiken

* Logs gehen beim Neustart **verloren**, auÃŸer ein Backup wird erstellt
* RAM wird fÃ¼r Logs verwendet â†’ bei sehr groÃŸen Logmengen kann RAM knapp werden
* **Cron muss korrekt eingerichtet sein** â€“ sonst startet ioBroker nicht und Logs existieren nicht
* Wenn der Pi abstÃ¼rzt, gehen alle Logs im RAM verloren

---

## ğŸ“ Haftungsausschluss

Dieses Projekt wird **ohne Garantie** bereitgestellt.
Der Autor Ã¼bernimmt **keine Haftung** fÃ¼r SchÃ¤den an Hardware, Datenverlust oder sonstige Probleme.
Benutzung erfolgt **auf eigene Verantwortung**.

---
